<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Remake Documentation | GameLauncher</title>
    <style>
        :root {
            --bg: #0d1117;
            --card-bg: #161b22;
            --border: #30363d;
            --text: #c9d1d9;
            --accent: #58a6ff;
            --note-bg: rgba(88, 166, 255, 0.05);
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); padding: 40px; line-height: 1.6; }
        .docs-container { max-width: 1000px; margin: auto; }
        
        /* Collapsible Styling */
        details { background: var(--card-bg); border: 1px solid var(--border); border-radius: 6px; margin-bottom: 20px; padding: 10px; }
        summary { font-weight: bold; cursor: pointer; padding: 10px; color: var(--accent); outline: none; }
        details[open] summary { border-bottom: 1px solid var(--border); margin-bottom: 10px; }

        pre { background: #000; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 13px; }
        code { color: #d2a8ff; }

        .tech-notes { background: var(--note-bg); border-left: 4px solid var(--accent); padding: 20px; margin-top: 10px; border-radius: 0 4px 4px 0; }
        .tech-notes h4 { margin-top: 0; color: var(--accent); text-transform: uppercase; font-size: 12px; letter-spacing: 1px; }
        .tech-notes ul { margin: 0; padding-left: 20px; }
        
        .status-tag { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 11px; background: #238636; color: white; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="docs-container">
    <span class="status-tag">Engine Core</span>
    <h1>GameLauncher.java</h1>
    <p>This is the entry point for the server. It handles the bootstrap sequence, environment variables, and the initialization of all game systems.</p>

    <details>
        <summary>View Code: Main Bootstrap & Environment Setup</summary>
        <pre><code>public static void main(String[] args) throws Exception {
    if (args.length < 5) {
        System.out.println("USE: worldid(int) debug(boolean) hosted(boolean) pvpworld(boolean) hammershield_enabled(boolean)");
        return;
    }
    Settings.WORLD_ID = Integer.parseInt(args[0]);
    Settings.DEBUG = Boolean.parseBoolean(args[1]);
    Settings.HOSTED = Boolean.parseBoolean(args[2]);
    Settings.SPAWN_WORLD = Boolean.parseBoolean(args[3]);
    Settings.CX_HAMMERSHIELD_ENABLED = Boolean.parseBoolean(args[4]);

    long currentTime = Utils.currentTimeMillis();
    Settings.init();
    // ... setup continues
}</code></pre>
        <div class="tech-notes">
            <h4>Technician Notes</h4>
            <ul>
                <li>We must pass exactly 5 arguments or the engine will kill the process immediately.</li>
                <li>We initialize <code>Settings</code> first to ensure global flags like <code>DEBUG</code> are available before any logging starts.</li>
            </ul>
        </div>
    </details>

    <details>
        <summary>View Code: Subsystem & Cache Loading</summary>
        <pre><code>Logger.log("Launcher", "Initing Cache...");
Cache.init();
Huffman.init();
BodyDefinitions.init();

Logger.log("Launcher", "Initing Data Files...");
Censor.init();
MapArchiveKeys.init();
ObjectSpawns.init();
NPCSpawns.init(); 
NPCDrops.init();
ShopsHandler.init();
GrandExchange.init();</code></pre>
        <div class="tech-notes">
            <h4>Technician Notes</h4>
            <ul>
                <li>We load the <code>Cache</code> and <code>Huffman</code> tables before data files because definitions (NPCs/Objects) depend on the store being open.</li>
                <li>We specifically load <code>ShopsHandler</code> and <code>GrandExchange</code> after definitions to prevent null pointers when mapping item IDs.</li>
            </ul>
        </div>
    </details>

    <details>
        <summary>View Code: Automated Maintenance Tasks</summary>
        <pre><code>private static void addAutoSavingTask() {
    GameExecutorManager.slowExecutor.scheduleWithFixedDelay(new Runnable() {
        @Override
        public void run() {
            try {
                savePlayers();
            } catch (Throwable e) {
                Logger.handle(e);
            }
        }
    }, 0, 1, TimeUnit.MINUTES);
}</code></pre>
        <div class="tech-notes">
            <h4>Technician Notes</h4>
            <ul>
                <li>We use a 1-minute interval for <code>savePlayers()</code> to minimize data loss in the event of a crash.</li>
                <li>We run these on the <code>slowExecutor</code> to ensure that saving large batches of player data doesn't interfere with the main game tick.</li>
            </ul>
        </div>
    </details>

    <details>
        <summary>View Code: The Shutdown Hook</summary>
        <pre><code>Runtime.getRuntime().addShutdownHook(new Thread() {
    @Override
    public void run() {
        savePlayers(); 
    }
});</code></pre>
        <div class="tech-notes">
            <h4>Technician Notes</h4>
            <ul>
                <li>We registered this hook as a failsafe; if we manually terminate the process, the JVM will attempt one final save of all active players.</li>
                <li>We must ensure the database or file system remains accessible until this thread completes.</li>
            </ul>
        </div>
    </details>

</div>

</body>
</html>
